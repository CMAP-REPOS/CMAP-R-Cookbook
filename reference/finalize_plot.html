<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Arrange and save CMAP ggplot chart — finalize_plot • cmapplot</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Arrange and save CMAP ggplot chart — finalize_plot" />
<meta property="og:description" content="finalize_plot will place a ggplot into a frame defined by CMAP design
standards. It will align your title and caption to the left, add a horizontal
line on top, and make other adjustments. It can show you the final plot and/or
export it as a raster or vector file. This function will not apply CMAP design
standards to the plot itself: use with theme_cmap() for that." />
<meta property="og:image" content="https://cmap-repos.github.io/cmapplot/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmapplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/colors.html">Applying CMAP color schemes</a>
    </li>
    <li>
      <a href="../articles/plots.html">Creating CMAP-themed plots</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CMAP-REPOS/cmapplot/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Arrange and save CMAP ggplot chart</h1>
    <small class="dont-index">Source: <a href='https://github.com/CMAP-REPOS/cmapplot/blob/master/R/finalize_plot.R'><code>R/finalize_plot.R</code></a></small>
    <div class="hidden name"><code>finalize_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>finalize_plot</code> will place a ggplot into a frame defined by CMAP design
standards. It will align your title and caption to the left, add a horizontal
line on top, and make other adjustments. It can show you the final plot and/or
export it as a raster or vector file. This function will not apply CMAP design
standards to the plot itself: use with <code><a href='theme_cmap.html'>theme_cmap()</a></code> for that.</p>
    </div>

    <pre class="usage"><span class='fu'>finalize_plot</span>(input_plot = <span class='kw'>NULL</span>, title = <span class='st'>""</span>, caption = <span class='st'>""</span>, width =
 <span class='fl'>670</span><span class='op'>/</span><span class='fl'>72</span>, height = <span class='fl'>400</span><span class='op'>/</span><span class='fl'>72</span>, title_width = <span class='kw'>NULL</span>, ppi = <span class='fl'>300</span>, mode = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"plot"</span>),
 filename = <span class='st'>""</span>, caption_valign = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"top"</span>, <span class='st'>"bottom"</span>), fill_bg = <span class='st'>"white"</span>,
 fill_canvas = <span class='st'>"gray90"</span>, overrides = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>())</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input_plot</th>
      <td><p>ggplot object, the variable name of the plot you have
created that you want to finalize. If null (the default), the most recent
plot will be retrieved via <code><a href='https://ggplot2.tidyverse.org/reference/last_plot.html'>ggplot2::last_plot()</a></code>.</p></td>
    </tr>
    <tr>
      <th>title, caption</th>
      <td><p>Char, the text you want to appear in the title and
caption blocks. If empty, any non-Null values from <code>input_plot</code> will be
retrieved. These blocks take html formatting, so manual text breaks can be
created with <code>&lt;br&gt;</code> and formatting can be changed with <code>&lt;span&gt;</code>.</p></td>
    </tr>
    <tr>
      <th>width, height</th>
      <td><p>Numeric, the dimensions for the output image, including
the title. Units in inches, which interacts with <code>ppi</code> to define the
pixel dimensions of raster outputs. Default is 9.31 inches wide (670/72) and
5.56 inches tall (400/72), to match Comms specification of 670px by 400px at
72ppi.</p></td>
    </tr>
    <tr>
      <th>title_width</th>
      <td><p>Numeric, the width in inches for the title. If unspecified,
use 25 percent of the total output width (per Comms guidance).</p></td>
    </tr>
    <tr>
      <th>ppi</th>
      <td><p>Numeric, the resolution of exported images (pixels per inch).
Default = 300.</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>Vector, the action(s) to be taken with the plot. Save using any of
the following: <code>png</code>, <code>tiff</code>, <code>jpeg</code>, <code>bmp</code>, <code>svg</code>,
<code>pdf</code>, <code>ps</code>. View in R with: <code>plot</code>, <code>window</code> (`window`
currently works on computers running Windows). Return an object with
<code>object</code>.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>Char, the file path and name you want the plot to be saved to.
You may specify an extension to use. If you don't, the correct extension
will be added for you.</p></td>
    </tr>
    <tr>
      <th>caption_valign</th>
      <td><p>Char, align the caption text at the top or the bottom of
the available space between the title and gutter created by
<code>margin_v4</code>. This argument accepts abbreviations, too: <code><a href='https://rdrr.io/r/base/c.html'>c("top",
"t", "bottom", "b")</a></code>. Note that <code>margin_v3</code> creates space above the
caption when it is aligned top, and below the caption when it is aligned
bottom.</p></td>
    </tr>
    <tr>
      <th>fill_bg, fill_canvas</th>
      <td><p>Char, strings that represent colors R can
interpret. They are used to fill behind and around the finished plot,
respectively.</p></td>
    </tr>
    <tr>
      <th>overrides</th>
      <td><p>Named list, overrides the default drawing attributes defined
in <code>cmapplot_globals$plot_constants</code> which are drawn by
<code>finalize_plot()</code> (this is most of them). Units are in bigpts (1/72 of
an inch).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If and only if <code>"object"</code> is one of the modes specified, a gTree
 object is returned. gTree is an assembly of grobs, or graphical objects,
 that can be drawn using the grid package.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Exports from this function use Cairo graphics drivers, while drawing within R
is done with default (Windows) drivers. <code>mode = "object"</code> also returns a
gTree object that can be stored and drawn later with <code><a href='https://rdrr.io/r/grid/grid.draw.html'>grid::grid.draw()</a></code>.
Lines drawn by any <code>geom_line()</code> geoms without line widths explicitly
specified are assigned a thicker width (specifically,
<code>cmapplot_globals$plot_constants$lwd_plotline</code>) in all outputs except for
when exporting as an object.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='kw'>econ_plot</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span>(data = <span class='kw'>cluster_jobchange</span>,
                    mapping = <span class='fu'>aes</span>(
                      x = <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='kw'>name</span>, <span class='kw'>jobchange</span>),
                      y = <span class='kw'>jobchange</span>,
                      fill = <span class='kw'>category</span>)) <span class='op'>+</span>
  <span class='fu'>geom_col</span>() <span class='op'>+</span>
  <span class='fu'>coord_flip</span>() <span class='op'>+</span>
  <span class='fu'><a href='theme_cmap.html'>theme_cmap</a></span>(gridlines = <span class='st'>"v"</span>, hline = <span class='fl'>0</span>) <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span>(labels = <span class='kw'>scales</span>::<span class='kw'><a href='https://scales.r-lib.org//reference/label_number.html'>comma</a></span>)

<span class='fu'>finalize_plot</span>(<span class='kw'>econ_plot</span>,
               <span class='st'>"Cluster-level employment changes in the Chicago MSA, 2001-17"</span>,
               <span class='st'>"Source: Chicago Metropolitan Agency for Planning analysis"</span>,
               mode = <span class='st'>"window"</span>,
               height = <span class='fl'>6</span>,
               width = <span class='fl'>8</span>,
               title_width = <span class='fl'>2.5</span>,
               overrides = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(margin_h3 = <span class='fl'>30</span>))

<span class='kw'>transit_plot</span> <span class='op'>&lt;-</span> <span class='kw'>transit_ridership</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(system = <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span>(
    <span class='kw'>system</span> <span class='op'>==</span> <span class='st'>"cta_bus"</span> <span class='op'>~</span> <span class='st'>"CTA (Bus)"</span>,
    <span class='kw'>system</span> <span class='op'>==</span> <span class='st'>"cta_rail"</span> <span class='op'>~</span> <span class='st'>"CTA (Rail)"</span>,
    <span class='kw'>system</span> <span class='op'>==</span> <span class='st'>"metra"</span> <span class='op'>~</span> <span class='st'>"Metra"</span>,
    <span class='kw'>system</span> <span class='op'>==</span> <span class='st'>"pace"</span> <span class='op'>~</span> <span class='st'>"Pace"</span>,
    <span class='kw'>system</span> <span class='op'>==</span> <span class='st'>"pace_ada"</span> <span class='op'>~</span> <span class='st'>"Paratransit"</span>
  )) <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span>(<span class='fu'>aes</span>(x = <span class='kw'>year</span>, y = <span class='kw'>ridership</span>, color = <span class='kw'>system</span>)) <span class='op'>+</span>
  <span class='fu'>geom_line</span>() <span class='op'>+</span>
  <span class='fu'><a href='theme_cmap.html'>theme_cmap</a></span>(max_columns = <span class='fl'>3</span>)

<span class='fu'>finalize_plot</span>(<span class='kw'>transit_plot</span>,
               <span class='st'>"Transit ridership in the RTA region over time, 1980-2019
               (in millions)."</span>,
               <span class='st'>"Source: Chicago Metropolitan Agency for Planning
               analysis of data from the Regional Transportation Authority."</span>,
               mode=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"plot"</span>, <span class='st'>"pdf"</span>),
               filename = <span class='st'>"foo"</span>,
               overrides = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(margin_h3 = <span class='fl'>10</span>))
}
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew Stern, Sarah Buchhorn, Daniel Comeaux, Martin Menninger, Noel Peterson, Greta Ritzenthaler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


